!function(){"use strict";function t(t,e){this.x=t,this.y=e}var e={clip:function(t,e,i){for(var n,s=p(e),o=p(i),r=s[t](o),h=r.getNumInnerPoly(),u=0,l=[];h>u;u++)n=r.getInnerPoly(u),l.push({vertices:c(n),isHole:n.isHole()});return l}},i=0,n=1,s=2,o={NH:i,BH:n,TH:s,next_h_state:[[n,s,s,n,i,i],[i,i,i,i,s,s],[i,i,i,i,n,n]]},r=function(t,e,i,n){this.x=t,this.y=e,this.w=i,this.h=n};r.prototype={getMaxY:function(){return this.y+this.h},getMinY:function(){return this.y},getMaxX:function(){return this.x+this.w},getMinX:function(){return this.x},toString:function(){return"["+x.toString()+" "+y.toString()+" "+w.toString()+" "+h.toString()+"]"}};var u=function(){this.bundle=B.create2DArray(2,2),this.vertex=new t,this.bot=new t,this.top=new t,this.xb,this.xt,this.dx,this.type,this.bside=[],this.bstate=[],this.outp=[],this.prev,this.next,this.pred,this.succ,this.next_bound},l=function(e,i,n,s,o){this.ie=[],this.point=new t(n,s),this.next=o,this.ie[0]=e,this.ie[1]=i},d=function(t){this.y=t,this.first_bound,this.next},a=function(t,e){this.edge=t,this.xb=t.xb,this.xt=t.xt,this.dx=t.dx,this.prev=e},f=function(t,e){this.x=t,this.y=e,this.next=null},_={NUL:0,EMX:1,ELI:2,TED:3,ERI:4,RED:5,IMM:6,IMN:7,EMN:8,EMM:9,LED:10,ILI:11,BED:12,IRI:13,IMX:14,FUL:15,getType:function(t,e,i,n){return t+(e<<1)+(i<<2)+(n<<3)}},p=function(e){for(var i=new N,n=e.length,s=0;n>s;s++)i.addPoint(new t(e[s][0],e[s][1]));return i},c=function(t){for(var e=[],i=t.getNumPoints(),n=0;i>n;n++)e.push([t.getX(n),t.getY(n)]);return e},E=function(t,e){var i;for(i in t)if("undefined"==typeof e[i])return!1;for(i in t)if(t[i])switch(typeof t[i]){case"object":if(!E(t[i],e[i]))return!1;break;case"function":if("undefined"==typeof e[i]||"equals"!==i&&t[i].toString()!==e[i].toString())return!1;break;default:if(t[i]!==e[i])return!1}else if(e[i])return!1;for(i in e)if("undefined"==typeof t[i])return!1;return!0},B={create2DArray:function(t){for(var e=[],i=0;t>i;i++)e[i]=[];return e},valueEqual:function(t,e){return t===e?!0:E(t,e)?!0:!1},sortPointsClockwise:function(t){var e,i,n,s,o,r,h=!1,u=null,l=null,d=null,a=null,f=t;for(t instanceof b&&(t=t.toArray(),h=!0),i=0,n=t.length;n>i;i++)s=t[i],(null===u||u.y>s.y||u.y===s.y&&s.x<u.x)&&(u=s),(null===l||l.y<s.y||l.y===s.y&&s.x>l.x)&&(l=s),(null===a||a.x<s.x||a.x===s.x&&s.y<a.y)&&(a=s),(null===d||d.x>s.x||d.x===s.x&&s.y>d.y)&&(d=s,e=i);if(e>0){for(f=[],o=0,i=e,n=t.length;n>i;i++)f[o++]=t[i];for(i=0;e>i;i++)f[o++]=t[i];t=f}for(r=!1,i=0,n=t.length;n>i;i++){if(s=t[i],E(s,l)){r=!0;break}if(E(s,u))break}if(r){for(f=[],f[0]=t[0],o=1,i=t.length-1;i>0;i--)f[o++]=t[i];t=f}return h?new b(t):t}},b=function(t){this._array=[],null!=t&&(this._array=t)};b.prototype={add:function(t){this._array.push(t)},get:function(t){return this._array[t]},size:function(){return this._array.length},clear:function(){this._array=[]},equals:function(t){if(this._array.length!=t.size())return!1;for(var e=0,i=this._array.length;i>e;e++)if(!B.valueEqual(this._array[e],t.get(e)))return!1;return!0},hashCode:function(){return 0},isEmpty:function(){return 0==this._array.length},toArray:function(){return this._array}};var L={DEBUG:!1,GPC_EPSILON:2.220446049250313e-16,GPC_VERSION:"2.31",LEFT:0,RIGHT:1,ABOVE:0,BELOW:1,CLIP:0,SUBJ:1,intersection:function(t,e,i){return(null==i||void 0==i)&&(i="PolyDefault"),this.clip(A.GPC_INT,t,e,i)},union:function(t,e,i){return(null==i||void 0==i)&&(i="PolyDefault"),this.clip(A.GPC_UNION,t,e,i)},xor:function(t,e,i){return(null==i||void 0==i)&&(i="PolyDefault"),this.clip(A.GPC_XOR,t,e,i)},difference:function(t,e,i){return(null==i||void 0==i)&&(i="PolyDefault"),this.clip(A.GPC_DIFF,e,t,i)},intersection:function(t,e){return this.clip(A.GPC_INT,t,e,"PolyDefault.class")},createNewPoly:function(t){switch(t){case"PolySimple":return new U;case"PolyDefault":return new N;case"PolyDefault.class":return new N}return null},clip:function(t,e,i,n){var s,r,h,u,l,d,a,f,p,c,E,x,B,b,y,L,I,O,N,C,V,U,J,w,T,X,M,H,W,R,G,F,Y,k,z,q,Q,j,K,Z,$=this.createNewPoly(n);if(e.isEmpty()&&i.isEmpty()||e.isEmpty()&&(t===A.GPC_INT||t===A.GPC_DIFF)||i.isEmpty()&&t===A.GPC_INT)return $;if(t!==A.GPC_INT&&t!==A.GPC_DIFF||e.isEmpty()||i.isEmpty()||this.minimax_test(e,i,t),s=new m,r=new D,h=null,u=null,e.isEmpty()||(h=this.build_lmt(s,r,e,this.SUBJ,t)),i.isEmpty()||(u=this.build_lmt(s,r,i,this.CLIP,t)),null==s.top_node)return $;for(E=r.build_sbt(),l=[],l[0]=this.LEFT,l[1]=this.LEFT,t===A.GPC_DIFF&&(l[this.CLIP]=this.RIGHT),d=s.top_node,a=new S,x=new g,f=0;f<E.length;){if(B=E[f++],b=0,y=0,f<E.length&&(b=E[f],y=b-B),null!=d&&d.y==B){for(G=d.first_bound;null!=G;G=G.next_bound)this.add_edge_to_aet(x,G);d=d.next}for(X=-Number.MAX_VALUE,M=x.top_node,H=x.top_node,x.top_node.bundle[this.ABOVE][x.top_node.type]=x.top_node.top.y!=B?1:0,x.top_node.bundle[this.ABOVE][0==x.top_node.type?1:0]=0,x.top_node.bstate[this.ABOVE]=P.UNBUNDLED,Y=x.top_node.next;null!=Y;Y=Y.next)z=Y.type,q=0==Y.type?1:0,Y.bundle[this.ABOVE][z]=Y.top.y!=B?1:0,Y.bundle[this.ABOVE][q]=0,Y.bstate[this.ABOVE]=P.UNBUNDLED,1==Y.bundle[this.ABOVE][z]&&(this.EQ(M.xb,Y.xb)&&this.EQ(M.dx,Y.dx)&&M.top.y!=B&&(Y.bundle[this.ABOVE][z]^=M.bundle[this.ABOVE][z],Y.bundle[this.ABOVE][q]=M.bundle[this.ABOVE][q],Y.bstate[this.ABOVE]=P.BUNDLE_HEAD,M.bundle[this.ABOVE][this.CLIP]=0,M.bundle[this.ABOVE][this.SUBJ]=0,M.bstate[this.ABOVE]=P.BUNDLE_TAIL),M=Y);for(Q=[],Q[this.CLIP]=o.NH,Q[this.SUBJ]=o.NH,j=[],j[this.CLIP]=0,j[this.SUBJ]=0,C=null,G=x.top_node;null!=G;G=G.next){if(j[this.CLIP]=G.bundle[this.ABOVE][this.CLIP]+(G.bundle[this.BELOW][this.CLIP]<<1),j[this.SUBJ]=G.bundle[this.ABOVE][this.SUBJ]+(G.bundle[this.BELOW][this.SUBJ]<<1),(0!=j[this.CLIP]||0!=j[this.SUBJ])&&(G.bside[this.CLIP]=l[this.CLIP],G.bside[this.SUBJ]=l[this.SUBJ],p=!1,U=0,J=0,w=0,T=0,t===A.GPC_DIFF||t===A.GPC_INT?(p=0!=j[this.CLIP]&&(0!=l[this.SUBJ]||0!=Q[this.SUBJ])||0!=j[this.SUBJ]&&(0!=l[this.CLIP]||0!=Q[this.CLIP])||0!=j[this.CLIP]&&0!=j[this.SUBJ]&&l[this.CLIP]==l[this.SUBJ],U=0!=l[this.CLIP]&&0!=l[this.SUBJ]?1:0,J=0!=(l[this.CLIP]^0!=G.bundle[this.ABOVE][this.CLIP]&&l[this.SUBJ]^G.bundle[this.ABOVE][this.SUBJ])?1:0,w=0!=(l[this.CLIP]^(Q[this.CLIP]!=o.NH?1:0))&&0!=(l[this.SUBJ]^(Q[this.SUBJ]!=o.NH?1:0))?1:0,T=0!=(l[this.CLIP]^(Q[this.CLIP]!=o.NH?1:0)^G.bundle[this.BELOW][this.CLIP])&&0!=(l[this.SUBJ]^(Q[this.SUBJ]!=o.NH?1:0)^G.bundle[this.BELOW][this.SUBJ])?1:0):t===A.GPC_XOR?(p=0!=j[this.CLIP]||0!=j[this.SUBJ],U=l[this.CLIP]^l[this.SUBJ],J=l[this.CLIP]^G.bundle[this.ABOVE][this.CLIP]^(l[this.SUBJ]^G.bundle[this.ABOVE][this.SUBJ]),w=l[this.CLIP]^(Q[this.CLIP]!=o.NH?1:0)^(l[this.SUBJ]^(Q[this.SUBJ]!=o.NH?1:0)),T=l[this.CLIP]^(Q[this.CLIP]!=o.NH?1:0)^G.bundle[this.BELOW][this.CLIP]^(l[this.SUBJ]^(Q[this.SUBJ]!=o.NH?1:0)^G.bundle[this.BELOW][this.SUBJ])):t===A.GPC_UNION&&(p=!((0==j[this.CLIP]||0!=l[this.SUBJ]&&0==Q[this.SUBJ])&&(0==j[this.SUBJ]||0!=l[this.CLIP]&&0==Q[this.CLIP])&&(0==j[this.CLIP]||0==j[this.SUBJ]||l[this.CLIP]!=l[this.SUBJ])),U=0!=l[this.CLIP]||0!=l[this.SUBJ]?1:0,J=0!=(l[this.CLIP]^G.bundle[this.ABOVE][this.CLIP])||l[this.SUBJ]^0!=G.bundle[this.ABOVE][this.SUBJ]?1:0,w=0!=(l[this.CLIP]^(Q[this.CLIP]!=o.NH?1:0))||0!=(l[this.SUBJ]^(Q[this.SUBJ]!=o.NH?1:0))?1:0,T=0!=(l[this.CLIP]^(Q[this.CLIP]!=o.NH?1:0)^G.bundle[this.BELOW][this.CLIP])||0!=(l[this.SUBJ]^(Q[this.SUBJ]!=o.NH?1:0)^G.bundle[this.BELOW][this.SUBJ])?1:0),l[this.CLIP]^=G.bundle[this.ABOVE][this.CLIP],l[this.SUBJ]^=G.bundle[this.ABOVE][this.SUBJ],0!=j[this.CLIP]&&(Q[this.CLIP]=o.next_h_state[Q[this.CLIP]][(j[this.CLIP]-1<<1)+l[this.CLIP]]),0!=j[this.SUBJ]&&(Q[this.SUBJ]=o.next_h_state[Q[this.SUBJ]][(j[this.SUBJ]-1<<1)+l[this.SUBJ]]),p))switch(V=G.xb,Z=_.getType(w,T,U,J)){case _.EMN:case _.IMN:G.outp[this.ABOVE]=a.add_local_min(V,B),X=V,C=G.outp[this.ABOVE];break;case _.ERI:V!=X&&(C.add_right(V,B),X=V),G.outp[this.ABOVE]=C,C=null;break;case _.ELI:G.outp[this.BELOW].add_left(V,B),X=V,C=G.outp[this.BELOW];break;case _.EMX:V!=X&&(C.add_left(V,B),X=V),a.merge_right(C,G.outp[this.BELOW]),C=null;break;case _.ILI:V!=X&&(C.add_left(V,B),X=V),G.outp[this.ABOVE]=C,C=null;break;case _.IRI:G.outp[this.BELOW].add_right(V,B),X=V,C=G.outp[this.BELOW],G.outp[this.BELOW]=null;break;case _.IMX:V!=X&&(C.add_right(V,B),X=V),a.merge_left(C,G.outp[this.BELOW]),C=null,G.outp[this.BELOW]=null;break;case _.IMM:V!=X&&(C.add_right(V,B),X=V),a.merge_left(C,G.outp[this.BELOW]),G.outp[this.BELOW]=null,G.outp[this.ABOVE]=a.add_local_min(V,B),C=G.outp[this.ABOVE];break;case _.EMM:V!=X&&(C.add_left(V,B),X=V),a.merge_right(C,G.outp[this.BELOW]),G.outp[this.BELOW]=null,G.outp[this.ABOVE]=a.add_local_min(V,B),C=G.outp[this.ABOVE];break;case _.LED:G.bot.y==B&&G.outp[this.BELOW].add_left(V,B),G.outp[this.ABOVE]=G.outp[this.BELOW],X=V;break;case _.RED:G.bot.y==B&&G.outp[this.BELOW].add_right(V,B),G.outp[this.ABOVE]=G.outp[this.BELOW],X=V}a.print()}for(G=x.top_node;null!=G;G=G.next)G.top.y==B?(F=G.prev,Y=G.next,null!=F?F.next=Y:x.top_node=Y,null!=Y&&(Y.prev=F),G.bstate[this.BELOW]==P.BUNDLE_HEAD&&null!=F&&F.bstate[this.BELOW]==P.BUNDLE_TAIL&&(F.outp[this.BELOW]=G.outp[this.BELOW],F.bstate[this.BELOW]=P.UNBUNDLED,null!=F.prev&&F.prev.bstate[this.BELOW]==P.BUNDLE_TAIL&&(F.bstate[this.BELOW]=P.BUNDLE_HEAD))):G.xt=G.top.y==b?G.top.x:G.bot.x+G.dx*(b-G.bot.y);if(f<r.sbt_entries){var te=new v;for(te.build_intersection_table(x,y),c=te.top_node;null!=c;c=c.next){if(M=c.ie[0],H=c.ie[1],!(0==M.bundle[this.ABOVE][this.CLIP]&&0==M.bundle[this.ABOVE][this.SUBJ]||0==H.bundle[this.ABOVE][this.CLIP]&&0==H.bundle[this.ABOVE][this.SUBJ]))switch(L=M.outp[this.ABOVE],I=H.outp[this.ABOVE],O=c.point.x,N=c.point.y+B,W=0!=M.bundle[this.ABOVE][this.CLIP]&&0==M.bside[this.CLIP]||0!=H.bundle[this.ABOVE][this.CLIP]&&0!=H.bside[this.CLIP]||0==M.bundle[this.ABOVE][this.CLIP]&&0==H.bundle[this.ABOVE][this.CLIP]&&0!=M.bside[this.CLIP]&&0!=H.bside[this.CLIP]?1:0,R=0!=M.bundle[this.ABOVE][this.SUBJ]&&0==M.bside[this.SUBJ]||0!=H.bundle[this.ABOVE][this.SUBJ]&&0!=H.bside[this.SUBJ]||0==M.bundle[this.ABOVE][this.SUBJ]&&0==H.bundle[this.ABOVE][this.SUBJ]&&0!=M.bside[this.SUBJ]&&0!=H.bside[this.SUBJ]?1:0,w=0,T=0,U=0,J=0,t==A.GPC_DIFF||t==A.GPC_INT?(w=0!=W&&0!=R?1:0,T=0!=(W^H.bundle[this.ABOVE][this.CLIP])&&0!=(R^H.bundle[this.ABOVE][this.SUBJ])?1:0,U=0!=(W^M.bundle[this.ABOVE][this.CLIP])&&0!=(R^M.bundle[this.ABOVE][this.SUBJ])?1:0,J=0!=(W^H.bundle[this.ABOVE][this.CLIP]^M.bundle[this.ABOVE][this.CLIP])&&0!=(R^H.bundle[this.ABOVE][this.SUBJ]^M.bundle[this.ABOVE][this.SUBJ])?1:0):t==A.GPC_XOR?(w=W^R,T=W^H.bundle[this.ABOVE][this.CLIP]^(R^H.bundle[this.ABOVE][this.SUBJ]),U=W^M.bundle[this.ABOVE][this.CLIP]^(R^M.bundle[this.ABOVE][this.SUBJ]),J=W^H.bundle[this.ABOVE][this.CLIP]^M.bundle[this.ABOVE][this.CLIP]^(R^H.bundle[this.ABOVE][this.SUBJ]^M.bundle[this.ABOVE][this.SUBJ])):t==A.GPC_UNION&&(w=0!=W||0!=R?1:0,T=0!=(W^H.bundle[this.ABOVE][this.CLIP])||0!=(R^H.bundle[this.ABOVE][this.SUBJ])?1:0,U=0!=(W^M.bundle[this.ABOVE][this.CLIP])||0!=(R^M.bundle[this.ABOVE][this.SUBJ])?1:0,J=0!=(W^H.bundle[this.ABOVE][this.CLIP]^M.bundle[this.ABOVE][this.CLIP])||0!=(R^H.bundle[this.ABOVE][this.SUBJ]^M.bundle[this.ABOVE][this.SUBJ])?1:0),Z=_.getType(w,T,U,J)){case _.EMN:M.outp[this.ABOVE]=a.add_local_min(O,N),H.outp[this.ABOVE]=M.outp[this.ABOVE];break;case _.ERI:null!=L&&(L.add_right(O,N),H.outp[this.ABOVE]=L,M.outp[this.ABOVE]=null);break;case _.ELI:null!=I&&(I.add_left(O,N),M.outp[this.ABOVE]=I,H.outp[this.ABOVE]=null);break;case _.EMX:null!=L&&null!=I&&(L.add_left(O,N),a.merge_right(L,I),M.outp[this.ABOVE]=null,H.outp[this.ABOVE]=null);break;case _.IMN:M.outp[this.ABOVE]=a.add_local_min(O,N),H.outp[this.ABOVE]=M.outp[this.ABOVE];break;case _.ILI:null!=L&&(L.add_left(O,N),H.outp[this.ABOVE]=L,M.outp[this.ABOVE]=null);break;case _.IRI:null!=I&&(I.add_right(O,N),M.outp[this.ABOVE]=I,H.outp[this.ABOVE]=null);break;case _.IMX:null!=L&&null!=I&&(L.add_right(O,N),a.merge_left(L,I),M.outp[this.ABOVE]=null,H.outp[this.ABOVE]=null);break;case _.IMM:null!=L&&null!=I&&(L.add_right(O,N),a.merge_left(L,I),M.outp[this.ABOVE]=a.add_local_min(O,N),H.outp[this.ABOVE]=M.outp[this.ABOVE]);break;case _.EMM:null!=L&&null!=I&&(L.add_left(O,N),a.merge_right(L,I),M.outp[this.ABOVE]=a.add_local_min(O,N),H.outp[this.ABOVE]=M.outp[this.ABOVE])}if(0!=M.bundle[this.ABOVE][this.CLIP]&&(H.bside[this.CLIP]=0==H.bside[this.CLIP]?1:0),0!=H.bundle[this.ABOVE][this.CLIP]&&(M.bside[this.CLIP]=0==M.bside[this.CLIP]?1:0),0!=M.bundle[this.ABOVE][this.SUBJ]&&(H.bside[this.SUBJ]=0==H.bside[this.SUBJ]?1:0),0!=H.bundle[this.ABOVE][this.SUBJ]&&(M.bside[this.SUBJ]=0==M.bside[this.SUBJ]?1:0),F=M.prev,Y=H.next,null!=Y&&(Y.prev=M),M.bstate[this.ABOVE]==P.BUNDLE_HEAD)for(K=!0;K;)F=F.prev,K=null!=F&&F.bstate[this.ABOVE]!=P.BUNDLE_TAIL?!1:!1;null==F?(x.top_node.prev=H,H.next=x.top_node,x.top_node=M.next):(F.next.prev=H,H.next=F.next,F.next=M.next),M.next.prev=F,H.next.prev=H,M.next=Y}for(G=x.top_node;null!=G;G=G.next)Y=G.next,k=G.succ,G.top.y==b&&null!=k?(k.outp[this.BELOW]=G.outp[this.ABOVE],k.bstate[this.BELOW]=G.bstate[this.ABOVE],k.bundle[this.BELOW][this.CLIP]=G.bundle[this.ABOVE][this.CLIP],k.bundle[this.BELOW][this.SUBJ]=G.bundle[this.ABOVE][this.SUBJ],F=G.prev,null!=F?F.next=k:x.top_node=k,null!=Y&&(Y.prev=k),k.prev=F,k.next=Y):(G.outp[this.BELOW]=G.outp[this.ABOVE],G.bstate[this.BELOW]=G.bstate[this.ABOVE],G.bundle[this.BELOW][this.CLIP]=G.bundle[this.ABOVE][this.CLIP],G.bundle[this.BELOW][this.SUBJ]=G.bundle[this.ABOVE][this.SUBJ],G.xb=G.xt),G.outp[this.ABOVE]=null}}return $=a.getResult(n)},EQ:function(t,e){return Math.abs(t-e)<=this.GPC_EPSILON},PREV_INDEX:function(t,e){return(t-1+e)%e},NEXT_INDEX:function(t,e){return(t+1)%e},OPTIMAL:function(t,e){return t.getY(this.PREV_INDEX(e,t.getNumPoints()))!=t.getY(e)||t.getY(this.NEXT_INDEX(e,t.getNumPoints()))!=t.getY(e)},create_contour_bboxes:function(t){for(var e,i=[],n=t.getNumInnerPoly(),s=0;n>s;s++)e=t.getInnerPoly(s),i[s]=e.getBounds();return i},minimax_test:function(t,e,i){var n,s,o,r=this.create_contour_bboxes(t),h=this.create_contour_bboxes(e),u=t.getNumInnerPoly(),l=e.getNumInnerPoly(),d=B.create2DArray(u,l);for(n=0;u>n;n++)for(s=0;l>s;s++)d[n][s]=!(r[n].getMaxX()<h[s].getMinX()||r[n].getMinX()>h[s].getMaxX()||r[n].getMaxY()<h[s].getMinY()||r[n].getMinY()>h[s].getMaxY());for(s=0;l>s;s++){for(o=!1,n=0;!o&&u>n;n++)o=d[n][s];o||e.setContributing(s,!1)}if(i==A.GPC_INT)for(n=0;u>n;n++){for(o=!1,s=0;!o&&l>s;s++)o=d[n][s];o||t.setContributing(n,!1)}},bound_list:function(t,e){var i,n,s,o;if(null==t.top_node)return t.top_node=new d(e),t.top_node;for(i=null,n=t.top_node,s=!1;!s;)e<n.y?(o=n,n=new d(e),n.next=o,null==i?t.top_node=n:i.next=n,s=!0):e>n.y?null==n.next?(n.next=new d(e),n=n.next,s=!0):(i=n,n=n.next):s=!0;return n},insert_bound:function(t,e){var i,n,s;if(null==t.first_bound)t.first_bound=e;else for(i=!1,n=null,s=t.first_bound;!i;)e.bot.x<s.bot.x?(null==n?t.first_bound=e:n.next_bound=e,e.next_bound=s,i=!0):e.bot.x==s.bot.x?e.dx<s.dx?(null==n?t.first_bound=e:n.next_bound=e,e.next_bound=s,i=!0):null==s.next_bound?(s.next_bound=e,i=!0):(n=s,s=s.next_bound):null==s.next_bound?(s.next_bound=e,i=!0):(n=s,s=s.next_bound)},add_edge_to_aet:function(t,e){var i,n,s;if(null==t.top_node)t.top_node=e,e.prev=null,e.next=null;else for(i=t.top_node,n=null,s=!1;!s;)e.xb<i.xb?(e.prev=n,e.next=i,i.prev=e,null==n?t.top_node=e:n.next=e,s=!0):e.xb==i.xb?e.dx<i.dx?(e.prev=n,e.next=i,i.prev=e,null==n?t.top_node=e:n.next=e,s=!0):(n=i,null==i.next?(i.next=e,e.prev=i,e.next=null,s=!0):i=i.next):(n=i,null==i.next?(i.next=e,e.prev=i,e.next=null,s=!0):i=i.next)},add_to_sbtree:function(t,e){var i,n;if(null==t.sb_tree)return t.sb_tree=new J(e),t.sbt_entries++,void 0;for(i=t.sb_tree,n=!1;!n;)i.y>e?null==i.less?(i.less=new J(e),t.sbt_entries++,n=!0):i=i.less:i.y<e?null==i.more?(i.more=new J(e),t.sbt_entries++,n=!0):i=i.more:n=!0},build_lmt:function(t,e,i,n,s){var o,r,h,u,l,d,a,f,_,p,c,E,x,B,b=new I;for(o=0;o<i.getNumInnerPoly();o++)if(r=i.getInnerPoly(o),r.isContributing(0)){h=0,l=0,b=new I;for(var B=0;B<r.getNumPoints();B++)this.OPTIMAL(r,B)&&(f=r.getX(B),_=r.getY(B),b.addNode(f,_),this.add_to_sbtree(e,r.getY(B)),h++);for(var a=0;h>a;a++)if(b.FWD_MIN(a)){for(u=1,d=this.NEXT_INDEX(a,h);b.NOT_FMAX(d);)u++,d=this.NEXT_INDEX(d,h);for(p=a,c=b.getNode(l),c.bstate[this.BELOW]=P.UNBUNDLED,c.bundle[this.BELOW][this.CLIP]=0,c.bundle[this.BELOW][this.SUBJ]=0,B=0;u>B;B++)x=b.getNode(l+B),E=b.getNode(p),x.xb=E.vertex.x,x.bot.x=E.vertex.x,x.bot.y=E.vertex.y,p=this.NEXT_INDEX(p,h),E=b.getNode(p),x.top.x=E.vertex.x,x.top.y=E.vertex.y,x.dx=(E.vertex.x-x.bot.x)/(x.top.y-x.bot.y),x.type=n,x.outp[this.ABOVE]=null,x.outp[this.BELOW]=null,x.next=null,x.prev=null,x.succ=u>1&&u-1>B?b.getNode(l+B+1):null,x.pred=u>1&&B>0?b.getNode(l+B-1):null,x.next_bound=null,x.bside[this.CLIP]=s==A.GPC_DIFF?this.RIGHT:this.LEFT,x.bside[this.SUBJ]=this.LEFT;this.insert_bound(this.bound_list(t,b.getNode(a).vertex.y),c),l+=u}for(a=0;h>a;a++)if(b.REV_MIN(a)){for(u=1,d=this.PREV_INDEX(a,h);b.NOT_RMAX(d);)u++,d=this.PREV_INDEX(d,h);for(p=a,c=b.getNode(l),c.bstate[this.BELOW]=P.UNBUNDLED,c.bundle[this.BELOW][this.CLIP]=0,c.bundle[this.BELOW][this.SUBJ]=0,B=0;u>B;B++)x=b.getNode(l+B),E=b.getNode(p),x.xb=E.vertex.x,x.bot.x=E.vertex.x,x.bot.y=E.vertex.y,p=this.PREV_INDEX(p,h),E=b.getNode(p),x.top.x=E.vertex.x,x.top.y=E.vertex.y,x.dx=(E.vertex.x-x.bot.x)/(x.top.y-x.bot.y),x.type=n,x.outp[this.ABOVE]=null,x.outp[this.BELOW]=null,x.next=null,x.prev=null,x.succ=u>1&&u-1>B?b.getNode(l+B+1):null,x.pred=u>1&&B>0?b.getNode(l+B-1):null,x.next_bound=null,x.bside[this.CLIP]=s==A.GPC_DIFF?this.RIGHT:this.LEFT,x.bside[this.SUBJ]=this.LEFT;this.insert_bound(this.bound_list(t,b.getNode(a).vertex.y),c),l+=u}}else r.setContributing(0,!0);return b},add_st_edge:function(t,e,i,n){var s,o,r,h,u;return null==t?t=new a(i,null):(s=t.xt-t.xb-(i.xt-i.xb),i.xt>=t.xt||i.dx==t.dx||Math.abs(s)<=this.GPC_EPSILON?(o=t,t=new a(i,o)):(r=(i.xb-t.xb)/s,h=t.xb+r*(t.xt-t.xb),u=r*n,e.top_node=this.add_intersection(e.top_node,t.edge,i,h,u),t.prev=this.add_st_edge(t.prev,e,i,n))),t},add_intersection:function(t,e,i,n,s){var o;return null==t?t=new l(e,i,n,s,null):t.point.y>s?(o=t,t=new l(e,i,n,s,o)):t.next=this.add_intersection(t.next,e,i,n,s),t}},g=function(){this.top_node=null};g.prototype={print:function(){}};var P=function(t){this.m_State=t};P.UNBUNDLED=new P("UNBUNDLED"),P.BUNDLE_HEAD=new P("BUNDLE_HEAD"),P.BUNDLE_TAIL=new P("BUNDLE_TAIL"),P.prototype={toString:function(){return this.m_State}};var I=function(){this.m_List=new b};I.prototype={addNode:function(t,e){var i=new u;i.vertex.x=t,i.vertex.y=e,this.m_List.add(i)},getNode:function(t){return this.m_List.get(t)},FWD_MIN:function(t){var e=this.m_List,i=e.get(L.PREV_INDEX(t,e.size())),n=e.get(L.NEXT_INDEX(t,e.size())),s=e.get(t);return i.vertex.y>=s.vertex.y&&n.vertex.y>s.vertex.y},NOT_FMAX:function(t){var e=this.m_List,i=e.get(L.NEXT_INDEX(t,e.size())),n=e.get(t);return i.vertex.y>n.vertex.y},REV_MIN:function(t){var e=this.m_List,i=e.get(L.PREV_INDEX(t,e.size())),n=e.get(L.NEXT_INDEX(t,e.size())),s=e.get(t);return i.vertex.y>s.vertex.y&&n.vertex.y>=s.vertex.y},NOT_RMAX:function(t){var e=this.m_List,i=e.get(L.PREV_INDEX(t,e.size())),n=e.get(t);return i.vertex.y>n.vertex.y}};var O=function(t,e,i){this.polygonPoint1=t,this.polygonPoint2=e,this.intersectionPoint=i};O.prototype.toString=function(){return"P1 :"+polygonPoint1.toString()+" P2:"+polygonPoint2.toString()+" IP:"+intersectionPoint.toString()};var v=function(){this.top_node};v.prototype.build_intersection_table=function(t,e){var i,n=null;for(i=t.top_node;null!=i;i=i.next)(i.bstate[L.ABOVE]==P.BUNDLE_HEAD||0!=i.bundle[L.ABOVE][L.CLIP]||0!=i.bundle[L.ABOVE][L.SUBJ])&&(n=L.add_st_edge(n,this,i,e))};var m=function(){this.top_node};m.prototype.print=function(){for(var t=0,e=this.top_node;null!=e;)t++,e=e.next};var A=function(t){this.m_Type=t};A.GPC_DIFF=new A("Difference"),A.GPC_INT=new A("Intersection"),A.GPC_XOR=new A("Exclusive or"),A.GPC_UNION=new A("Union");var N=function(t){null==t&&(t=!1),this.m_IsHole=t,this.m_List=new b};N.prototype={equals:function(t){if(!(t instanceof N))return!1;var e=t;return this.m_IsHole!=e.m_IsHole?!1:E(this.m_List,e.m_List)?!0:!1},hashCode:function(){return 629+this.m_List.hashCode()},clear:function(){this.m_List.clear()},add:function(e,i){var n,s,o,r=[];if(r[0]=e,i&&(r[1]=i),2==r.length)this.addPointXY(r[0],r[1]);else if(1==r.length)if(r[0]instanceof t)this.addPoint(r[0]);else if(r[0]instanceof U)this.addPoly(r[0]);else if(r[0]instanceof Array)if(n=r[0],2==n.length&&n[0]instanceof Number&&n[1]instanceof Number)this.add(n[0],n[1]);else for(s=0,o=r[0].length;o>s;s++)this.add(r[0][s])},addPointXY:function(e,i){this.addPoint(new t(e,i))},addPoint:function(t){var e=this.m_List;0==e.size()&&e.add(new U),e.get(0).addPoint(t)},addPoly:function(t){var e=this.m_IsHole,i=this.m_List;if(i.size()>0&&e)throw"ERROR : Cannot add polys to something designated as a hole.";i.add(t)},isEmpty:function(){return this.m_List.isEmpty()},getBounds:function(){var t,e=this.m_List;return 0==e.size()?new r:1==e.size()?(t=this.getInnerPoly(0),t.getBounds()):(console.log("getBounds not supported on complex poly."),void 0)},getInnerPoly:function(t){return this.m_List.get(t)},getNumInnerPoly:function(){return this.m_List.size()},getNumPoints:function(){return this.m_List.get(0).getNumPoints()},getX:function(t){return this.m_List.get(0).getX(t)},getPoint:function(t){return this.m_List.get(0).getPoint(t)},getPoints:function(){return this.m_List.get(0).getPoints()},isPointInside:function(t){var e,i,n,s=this.m_List;if(!s.get(0).isPointInside(t))return!1;for(e=0,i=s.size();i>e;e++)if(n=s.get(e),n.isHole()&&n.isPointInside(t))return!1;return!0},getY:function(t){return this.m_List.get(0).getY(t)},isHole:function(){if(this.m_List.size()>1)throw"Cannot call on a poly made up of more than one poly.";return this.m_IsHole},setIsHole:function(t){if(this.m_List.size()>1)throw"Cannot call on a poly made up of more than one poly.";this.m_IsHole=t},isContributing:function(t){return this.m_List.get(t).isContributing(0)},setContributing:function(t,e){if(1!=this.m_List.size())throw"Only applies to polys of size 1";this.m_List.get(t).setContributing(0,e)},intersection:function(t){return L.intersection(t,this,"PolyDefault")},union:function(t){return L.union(t,this,"PolyDefault")},xor:function(t){return L.xor(t,this,"PolyDefault")},difference:function(t){return L.difference(t,this,"PolyDefault")},getArea:function(){for(var t,e,i=0,n=getNumInnerPoly(),s=0;n>s;s++)t=getInnerPoly(s),e=t.getArea()*(t.isHole()?-1:1),i+=e;return i},toString:function(){for(var e,i,n,s,o="",r=this.m_List,h=r.size(),u=0;h>u;u++){for(i=this.getInnerPoly(u),o+="InnerPoly("+u+").hole="+i.isHole(),e=[],n=0,s=i.getNumPoints();s>n;n++)e.push(new t(i.getX(n),i.getY(n)));for(e=B.sortPointsClockwise(e),n=0,s=e.length;s>n;n++)o+=e[n].toString()}return o}};var C=function(){this.maxTop,this.maxBottom,this.maxLeft,this.maxRight,this.vertices};C.prototype={fromArray:function(e){var i,n=0,s=e.length;for(this.vertices=[];s>n;n++)i=e[n],this.vertices.push(new t(i[0],i[1]))},normalize:function(){for(var t,e,i,n,s,o=this.vertices,r=this.vertices,h=o.length,u=0,l=!1;h>u;u++)e=o[u],(null==maxTop||maxTop.y>e.y||maxTop.y==e.y&&e.x<maxTop.x)&&(maxTop=e),(null==maxBottom||maxBottom.y<e.y||maxBottom.y==e.y&&e.x>maxBottom.x)&&(maxBottom=e),(null==maxRight||maxRight.x<e.x||maxRight.x==e.x&&e.y<maxRight.y)&&(maxRight=e),(null==maxLeft||maxLeft.x>e.x||maxLeft.x==e.x&&e.y>maxLeft.y)&&(maxLeft=e,t=u);if(t>0){for(r=[],i=0,u=t,h=o.length;h>u;u++)r[i++]=this.vertices[u];for(u=0;t>u;u++)r[i++]=this.vertices[u];o=r}for(n=0,s=this.vertices.length;s>n;n++){if(e=this.vertices[n],E(e,maxBottom)){l=!0;break}if(E(e,maxTop))break}if(l){for(r=[],r[0]=o[0],i=1,u=o.length-1;u>0;u--)r[i++]=this.vertices[u];o=r}},getVertexIndex:function(t){for(var e=0,i=this.vertices.length;i>e;e++)if(E(vertices[e],t))return e;return-1},insertVertex:function(t,e,i){var n,s,o,r=getVertexIndex(t),h=getVertexIndex(e);if(-1==r||-1==h)return!1;if(r>h&&(s=r,r=h,h=s),h==r+1){for(n=[],s=0;r>=s;s++)n[s]=this.vertices[s];for(n[h]=i,s=h,o=this.vertices.length;o>s;s++)n[s+1]=this.vertices[s];this.vertices=n}else h==vertices.length-1&&0==r&&this.vertices.push(i);return!0},clone:function(){var t=new C;return t.vertices=vertices.slice(this.vertices.length-1),t},toString:function(){for(var t,e=this.vertices,i="[",n=e.length,s=0;n>s;s++)t=e[s],i+=(s>0?",":"")+"["+t.x+","+t.y+"]";return i+="]"}};var V=function(t,e,i){var n=new f(e,i);this.v=[],this.v[L.LEFT]=n,this.v[L.RIGHT]=n,this.next=t,this.proxy=this,this.active=1,this.hole};V.prototype={add_right:function(t,e){var i=new f(t,e);this.proxy.v[L.RIGHT].next=i,this.proxy.v[L.RIGHT]=i},add_left:function(t,e){var i=this.proxy,n=new f(t,e);n.next=i.v[L.LEFT],i.v[L.LEFT]=n}};var U=function(){this.m_List=new b,this.m_Contributes=!0};U.prototype={equals:function(t){if(!(t instanceof U))return!1;var e,i,n,s,o,r,h,u=t,l=this.m_List.size(),d=u.m_List.size();if(l!=d)return!1;if(l>0){for(e=this.getX(0),i=this.getY(0),h=-1,r=0;-1==h&&d>r;r++)s=u.getX(r),o=u.getY(r),e==s&&i==o&&(h=r);if(-1==h)return!1;for(r=h,n=0;l>n;n++){if(e=this.getX(n),i=this.getY(n),s=u.getX(r),o=u.getY(r),e!=s||i!=o)return!1;r++,r>=d&&(r=0)}}return!0},hashCode:function(){var t=17;return t=37*t+this.m_List.hashCode()},toString:function(){return"PolySimple: num_points="+getNumPoints()},clear:function(){this.m_List.clear()},add:function(e,i){var n,s,o,r=[];if(r[0]=e,i&&(r[1]=i),2==r.length)this.addPointXY(r[0],r[1]);else if(1==r.length)if(r[0]instanceof t)this.addPoint(r[0]);else if(r[0]instanceof Poly)this.addPoly(r[0]);else if(r[0]instanceof Array)for(s=0,o=r[0].length;o>s;s++)n=r[0][s],this.add(n)},addPointXY:function(e,i){this.addPoint(new t(e,i))},addPoint:function(t){this.m_List.add(t)},addPoly:function(){throw"Cannot add poly to a simple poly."},isEmpty:function(){return this.m_List.isEmpty()},getBounds:function(){for(var t,e,i=Number.MAX_VALUE,n=Number.MAX_VALUE,s=-Number.MAX_VALUE,o=-Number.MAX_VALUE,h=this.m_List.size(),u=0;h>u;u++)t=this.getX(u),e=this.getY(u),i>t&&(i=t),t>s&&(s=t),n>e&&(n=e),e>o&&(o=e);return new r(i,n,s-i,o-n)},getInnerPoly:function(t){return 0!=t&&alert("PolySimple only has one poly"),this},getNumInnerPoly:function(){return 1},getNumPoints:function(){return this.m_List.size()},getX:function(t){return this.m_List.get(t).x},getY:function(t){return this.m_List.get(t).y},getPoint:function(t){return this.m_List.get(t)},getPoints:function(){return this.m_List.toArray()},isPointInside:function(t){for(var e=this.getPoints(),i=e.length-1,n=!1,s=e.length,o=0;s>o;o++)(e[o].y<t.y&&e[i].y>=t.y||e[i].y<t.y&&e[o].y>=t.y)&&e[o].x+(t.y-e[o].y)/(e[i].y-e[o].y)*(e[i].x-e[o].x)<t.x&&(n=!n),i=o;return n},isHole:function(){return!1},setIsHole:function(){throw"PolySimple cannot be a hole"},isContributing:function(t){if(0!=t)throw"PolySimple only has one poly";return this.m_Contributes},setContributing:function(t,e){if(0!=t)throw"PolySimple only has one poly";this.m_Contributes=e},intersection:function(t){return L.intersection(this,t,"PolySimple")},union:function(t){return L.union(this,t,"PolySimple")},xor:function(t){return L.xor(t,this,"PolySimple")},difference:function(t){return L.difference(t,this,"PolySimple")},getArea:function(){var t,e,i,n,s,o,r,h,u,l=0;if(this.getNumPoints()<3)return 0;for(t=this.getX(0),e=this.getY(0),h=1,u=this.getNumPoints()-1;u>h;h++)i=this.getX(h),n=this.getY(h),s=this.getX(h+1),o=this.getY(h+1),r=(s-i)*(e-n)-(t-i)*(o-n),l+=r;return l=.5*Math.abs(l)}};var S=function(){this.top_node};S.prototype={add_local_min:function(t,e){var i=this.top_node;return this.top_node=new V(i,t,e),this.top_node},merge_left:function(t,e){var i,n,s=this.top_node;if(e.proxy.hole=!0,t.proxy!=e.proxy)for(t.proxy.v[L.RIGHT].next=e.proxy.v[L.LEFT],e.proxy.v[L.LEFT]=t.proxy.v[L.LEFT],i=t.proxy,n=s;null!=n;n=n.next)n.proxy==i&&(n.active=0,n.proxy=e.proxy)},merge_right:function(t,e){var i,n,s=this.top_node;if(e.proxy.hole=!1,t.proxy!=e.proxy)for(e.proxy.v[L.RIGHT].next=t.proxy.v[L.LEFT],e.proxy.v[L.RIGHT]=t.proxy.v[L.RIGHT],i=t.proxy,n=s;null!=n;n=n.next)n.proxy==i&&(n.active=0,n.proxy=e.proxy)},count_contours:function(){for(var t,e,i=0,n=this.top_node;null!=n;n=n.next)if(0!=n.active){for(t=0,e=n.proxy.v[L.LEFT];null!=e;e=e.next)t++;t>2?(n.active=t,i++):n.active=0}return i},getResult:function(t){var e,i,n,s,o,r,h,u,l,d=this.top_node,a=L.createNewPoly(t),f=this.count_contours();if(f>0){for(s=0,e=null,i=d;null!=i;i=e)if(e=i.next,0!=i.active){for(n=a,f>1&&(n=L.createNewPoly(t)),i.proxy.hole&&n.setIsHole(i.proxy.hole),h=i.proxy.v[L.LEFT];null!=h;h=h.next)n.add(h.x,h.y);f>1&&a.addPoly(n),s++}for(u=a,a=L.createNewPoly(t),o=0,r=u.getNumInnerPoly();r>o;o++)l=u.getInnerPoly(o),l.isHole()||a.addPoly(l);for(o=0,r=u.getNumInnerPoly();r>o;o++)l=u.getInnerPoly(o),l.isHole()&&a.addPoly(l)}return a},print:function(){var t,e,i=this.top_node,n=0,s=null;for(t=i;null!=t;t=s)s=t.next,0!=t.active&&(e=0,n++)}};var J=function(t){this.y=t,this.less,this.more},D=function(){this.sbt_entries=0,this.sb_tree};D.prototype={build_sbt:function(){var t=[],e=0;return e=this.inner_build_sbt(e,t,this.sb_tree),t},inner_build_sbt:function(t,e,i){return null!=i.less&&(t=this.inner_build_sbt(t,e,i.less)),e[t]=i.y,t++,null!=i.more&&(t=this.inner_build_sbt(t,e,i.more)),t}},window.polyop=e}();