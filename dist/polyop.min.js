!function(){"use strict";function t(t,e){this.x=t,this.y=e}var e=0,i=1,n=2,s={NH:e,BH:i,TH:n,next_h_state:[[i,n,n,i,e,e],[e,e,e,e,n,n],[e,e,e,e,i,i]]},o=function(t,e,i,n){this.x=t,this.y=e,this.w=i,this.h=n};o.prototype={getMaxY:function(){return this.y+this.h},getMinY:function(){return this.y},getMaxX:function(){return this.x+this.w},getMinX:function(){return this.x},toString:function(){return"["+x.toString()+" "+y.toString()+" "+w.toString()+" "+h.toString()+"]"}};var r=function(){this.bundle=E.create2DArray(2,2),this.vertex=new t,this.bot=new t,this.top=new t,this.xb,this.xt,this.dx,this.type,this.bside=[],this.bstate=[],this.outp=[],this.prev,this.next,this.pred,this.succ,this.next_bound},u=function(e,i,n,s,o){this.ie=[],this.point=new t(n,s),this.next=o,this.ie[0]=e,this.ie[1]=i},l=function(t){this.y=t,this.first_bound,this.next},d=function(t,e){this.edge=t,this.xb=t.xb,this.xt=t.xt,this.dx=t.dx,this.prev=e},a=function(t,e){this.x=t,this.y=e,this.next=null},f={NUL:0,EMX:1,ELI:2,TED:3,ERI:4,RED:5,IMM:6,IMN:7,EMN:8,EMM:9,LED:10,ILI:11,BED:12,IRI:13,IMX:14,FUL:15,getType:function(t,e,i,n){return t+(e<<1)+(i<<2)+(n<<3)}},_=function(e){for(var i=new A,n=e.length,s=0;n>s;s++)i.addPoint(new t(e[s][0],e[s][1]));return i},c=function(t){for(var e=[],i=t.getNumPoints(),n=0;i>n;n++)e.push([t.getX(n),t.getY(n)]);return e},p=function(t,e){var i;for(i in t)if("undefined"==typeof e[i])return!1;for(i in t)if(t[i])switch(typeof t[i]){case"object":if(!p(t[i],e[i]))return!1;break;case"function":if("undefined"==typeof e[i]||"equals"!==i&&t[i].toString()!==e[i].toString())return!1;break;default:if(t[i]!==e[i])return!1}else if(e[i])return!1;for(i in e)if("undefined"==typeof t[i])return!1;return!0},E={create2DArray:function(t){for(var e=[],i=0;t>i;i++)e[i]=[];return e},valueEqual:function(t,e){return t===e?!0:p(t,e)?!0:!1},sortPointsClockwise:function(t){var e,i,n,s,o,r,h=!1,u=null,l=null,d=null,a=null,f=t;for(t instanceof B&&(t=t.toArray(),h=!0),i=0,n=t.length;n>i;i++)s=t[i],(null===u||u.y>s.y||u.y===s.y&&s.x<u.x)&&(u=s),(null===l||l.y<s.y||l.y===s.y&&s.x>l.x)&&(l=s),(null===a||a.x<s.x||a.x===s.x&&s.y<a.y)&&(a=s),(null===d||d.x>s.x||d.x===s.x&&s.y>d.y)&&(d=s,e=i);if(e>0){for(f=[],o=0,i=e,n=t.length;n>i;i++)f[o++]=t[i];for(i=0;e>i;i++)f[o++]=t[i];t=f}for(r=!1,i=0,n=t.length;n>i;i++){if(s=t[i],p(s,l)){r=!0;break}if(p(s,u))break}if(r){for(f=[],f[0]=t[0],o=1,i=t.length-1;i>0;i--)f[o++]=t[i];t=f}return h?new B(t):t}},B=function(t){this._array=[],null!=t&&(this._array=t)};B.prototype={add:function(t){this._array.push(t)},get:function(t){return this._array[t]},size:function(){return this._array.length},clear:function(){this._array=[]},equals:function(t){if(this._array.length!=t.size())return!1;for(var e=0,i=this._array.length;i>e;e++)if(!E.valueEqual(this._array[e],t.get(e)))return!1;return!0},hashCode:function(){return 0},isEmpty:function(){return 0==this._array.length},toArray:function(){return this._array}};var b={DEBUG:!1,GPC_EPSILON:2.220446049250313e-16,GPC_VERSION:"2.31",LEFT:0,RIGHT:1,ABOVE:0,BELOW:1,CLIP:0,SUBJ:1,intersection:function(t,e,i){return(null==i||void 0==i)&&(i="PolyDefault"),this.clip(m.GPC_INT,t,e,i)},union:function(t,e,i){return(null==i||void 0==i)&&(i="PolyDefault"),this.clip(m.GPC_UNION,t,e,i)},xor:function(t,e,i){return(null==i||void 0==i)&&(i="PolyDefault"),this.clip(m.GPC_XOR,t,e,i)},difference:function(t,e,i){return(null==i||void 0==i)&&(i="PolyDefault"),this.clip(m.GPC_DIFF,e,t,i)},intersection:function(t,e){return this.clip(m.GPC_INT,t,e,"PolyDefault.class")},createNewPoly:function(t){switch(t){case"PolySimple":return new V;case"PolyDefault":return new A;case"PolyDefault.class":return new A}return null},clip:function(t,e,i,n){var o,r,h,u,l,d,a,_,c,p,x,E,B,b,y,P,v,A,N,C,V,S,D,w,T,X,M,H,W,R,G,F,Y,k,z,q,Q,j,K,Z,$=this.createNewPoly(n);if(e.isEmpty()&&i.isEmpty()||e.isEmpty()&&(t===m.GPC_INT||t===m.GPC_DIFF)||i.isEmpty()&&t===m.GPC_INT)return $;if(t!==m.GPC_INT&&t!==m.GPC_DIFF||e.isEmpty()||i.isEmpty()||this.minimax_test(e,i,t),o=new O,r=new J,h=null,u=null,e.isEmpty()||(h=this.build_lmt(o,r,e,this.SUBJ,t)),i.isEmpty()||(u=this.build_lmt(o,r,i,this.CLIP,t)),null==o.top_node)return $;for(x=r.build_sbt(),l=[],l[0]=this.LEFT,l[1]=this.LEFT,t===m.GPC_DIFF&&(l[this.CLIP]=this.RIGHT),d=o.top_node,a=new U,E=new L,_=0;_<x.length;){if(B=x[_++],b=0,y=0,_<x.length&&(b=x[_],y=b-B),null!=d&&d.y==B){for(G=d.first_bound;null!=G;G=G.next_bound)this.add_edge_to_aet(E,G);d=d.next}for(X=-Number.MAX_VALUE,M=E.top_node,H=E.top_node,E.top_node.bundle[this.ABOVE][E.top_node.type]=E.top_node.top.y!=B?1:0,E.top_node.bundle[this.ABOVE][0==E.top_node.type?1:0]=0,E.top_node.bstate[this.ABOVE]=g.UNBUNDLED,Y=E.top_node.next;null!=Y;Y=Y.next)z=Y.type,q=0==Y.type?1:0,Y.bundle[this.ABOVE][z]=Y.top.y!=B?1:0,Y.bundle[this.ABOVE][q]=0,Y.bstate[this.ABOVE]=g.UNBUNDLED,1==Y.bundle[this.ABOVE][z]&&(this.EQ(M.xb,Y.xb)&&this.EQ(M.dx,Y.dx)&&M.top.y!=B&&(Y.bundle[this.ABOVE][z]^=M.bundle[this.ABOVE][z],Y.bundle[this.ABOVE][q]=M.bundle[this.ABOVE][q],Y.bstate[this.ABOVE]=g.BUNDLE_HEAD,M.bundle[this.ABOVE][this.CLIP]=0,M.bundle[this.ABOVE][this.SUBJ]=0,M.bstate[this.ABOVE]=g.BUNDLE_TAIL),M=Y);for(Q=[],Q[this.CLIP]=s.NH,Q[this.SUBJ]=s.NH,j=[],j[this.CLIP]=0,j[this.SUBJ]=0,C=null,G=E.top_node;null!=G;G=G.next){if(j[this.CLIP]=G.bundle[this.ABOVE][this.CLIP]+(G.bundle[this.BELOW][this.CLIP]<<1),j[this.SUBJ]=G.bundle[this.ABOVE][this.SUBJ]+(G.bundle[this.BELOW][this.SUBJ]<<1),(0!=j[this.CLIP]||0!=j[this.SUBJ])&&(G.bside[this.CLIP]=l[this.CLIP],G.bside[this.SUBJ]=l[this.SUBJ],c=!1,S=0,D=0,w=0,T=0,t===m.GPC_DIFF||t===m.GPC_INT?(c=0!=j[this.CLIP]&&(0!=l[this.SUBJ]||0!=Q[this.SUBJ])||0!=j[this.SUBJ]&&(0!=l[this.CLIP]||0!=Q[this.CLIP])||0!=j[this.CLIP]&&0!=j[this.SUBJ]&&l[this.CLIP]==l[this.SUBJ],S=0!=l[this.CLIP]&&0!=l[this.SUBJ]?1:0,D=0!=(l[this.CLIP]^0!=G.bundle[this.ABOVE][this.CLIP]&&l[this.SUBJ]^G.bundle[this.ABOVE][this.SUBJ])?1:0,w=0!=(l[this.CLIP]^(Q[this.CLIP]!=s.NH?1:0))&&0!=(l[this.SUBJ]^(Q[this.SUBJ]!=s.NH?1:0))?1:0,T=0!=(l[this.CLIP]^(Q[this.CLIP]!=s.NH?1:0)^G.bundle[this.BELOW][this.CLIP])&&0!=(l[this.SUBJ]^(Q[this.SUBJ]!=s.NH?1:0)^G.bundle[this.BELOW][this.SUBJ])?1:0):t===m.GPC_XOR?(c=0!=j[this.CLIP]||0!=j[this.SUBJ],S=l[this.CLIP]^l[this.SUBJ],D=l[this.CLIP]^G.bundle[this.ABOVE][this.CLIP]^(l[this.SUBJ]^G.bundle[this.ABOVE][this.SUBJ]),w=l[this.CLIP]^(Q[this.CLIP]!=s.NH?1:0)^(l[this.SUBJ]^(Q[this.SUBJ]!=s.NH?1:0)),T=l[this.CLIP]^(Q[this.CLIP]!=s.NH?1:0)^G.bundle[this.BELOW][this.CLIP]^(l[this.SUBJ]^(Q[this.SUBJ]!=s.NH?1:0)^G.bundle[this.BELOW][this.SUBJ])):t===m.GPC_UNION&&(c=!((0==j[this.CLIP]||0!=l[this.SUBJ]&&0==Q[this.SUBJ])&&(0==j[this.SUBJ]||0!=l[this.CLIP]&&0==Q[this.CLIP])&&(0==j[this.CLIP]||0==j[this.SUBJ]||l[this.CLIP]!=l[this.SUBJ])),S=0!=l[this.CLIP]||0!=l[this.SUBJ]?1:0,D=0!=(l[this.CLIP]^G.bundle[this.ABOVE][this.CLIP])||l[this.SUBJ]^0!=G.bundle[this.ABOVE][this.SUBJ]?1:0,w=0!=(l[this.CLIP]^(Q[this.CLIP]!=s.NH?1:0))||0!=(l[this.SUBJ]^(Q[this.SUBJ]!=s.NH?1:0))?1:0,T=0!=(l[this.CLIP]^(Q[this.CLIP]!=s.NH?1:0)^G.bundle[this.BELOW][this.CLIP])||0!=(l[this.SUBJ]^(Q[this.SUBJ]!=s.NH?1:0)^G.bundle[this.BELOW][this.SUBJ])?1:0),l[this.CLIP]^=G.bundle[this.ABOVE][this.CLIP],l[this.SUBJ]^=G.bundle[this.ABOVE][this.SUBJ],0!=j[this.CLIP]&&(Q[this.CLIP]=s.next_h_state[Q[this.CLIP]][(j[this.CLIP]-1<<1)+l[this.CLIP]]),0!=j[this.SUBJ]&&(Q[this.SUBJ]=s.next_h_state[Q[this.SUBJ]][(j[this.SUBJ]-1<<1)+l[this.SUBJ]]),c))switch(V=G.xb,Z=f.getType(w,T,S,D)){case f.EMN:case f.IMN:G.outp[this.ABOVE]=a.add_local_min(V,B),X=V,C=G.outp[this.ABOVE];break;case f.ERI:V!=X&&(C.add_right(V,B),X=V),G.outp[this.ABOVE]=C,C=null;break;case f.ELI:G.outp[this.BELOW].add_left(V,B),X=V,C=G.outp[this.BELOW];break;case f.EMX:V!=X&&(C.add_left(V,B),X=V),a.merge_right(C,G.outp[this.BELOW]),C=null;break;case f.ILI:V!=X&&(C.add_left(V,B),X=V),G.outp[this.ABOVE]=C,C=null;break;case f.IRI:G.outp[this.BELOW].add_right(V,B),X=V,C=G.outp[this.BELOW],G.outp[this.BELOW]=null;break;case f.IMX:V!=X&&(C.add_right(V,B),X=V),a.merge_left(C,G.outp[this.BELOW]),C=null,G.outp[this.BELOW]=null;break;case f.IMM:V!=X&&(C.add_right(V,B),X=V),a.merge_left(C,G.outp[this.BELOW]),G.outp[this.BELOW]=null,G.outp[this.ABOVE]=a.add_local_min(V,B),C=G.outp[this.ABOVE];break;case f.EMM:V!=X&&(C.add_left(V,B),X=V),a.merge_right(C,G.outp[this.BELOW]),G.outp[this.BELOW]=null,G.outp[this.ABOVE]=a.add_local_min(V,B),C=G.outp[this.ABOVE];break;case f.LED:G.bot.y==B&&G.outp[this.BELOW].add_left(V,B),G.outp[this.ABOVE]=G.outp[this.BELOW],X=V;break;case f.RED:G.bot.y==B&&G.outp[this.BELOW].add_right(V,B),G.outp[this.ABOVE]=G.outp[this.BELOW],X=V}a.print()}for(G=E.top_node;null!=G;G=G.next)G.top.y==B?(F=G.prev,Y=G.next,null!=F?F.next=Y:E.top_node=Y,null!=Y&&(Y.prev=F),G.bstate[this.BELOW]==g.BUNDLE_HEAD&&null!=F&&F.bstate[this.BELOW]==g.BUNDLE_TAIL&&(F.outp[this.BELOW]=G.outp[this.BELOW],F.bstate[this.BELOW]=g.UNBUNDLED,null!=F.prev&&F.prev.bstate[this.BELOW]==g.BUNDLE_TAIL&&(F.bstate[this.BELOW]=g.BUNDLE_HEAD))):G.xt=G.top.y==b?G.top.x:G.bot.x+G.dx*(b-G.bot.y);if(_<r.sbt_entries){var te=new I;for(te.build_intersection_table(E,y),p=te.top_node;null!=p;p=p.next){if(M=p.ie[0],H=p.ie[1],!(0==M.bundle[this.ABOVE][this.CLIP]&&0==M.bundle[this.ABOVE][this.SUBJ]||0==H.bundle[this.ABOVE][this.CLIP]&&0==H.bundle[this.ABOVE][this.SUBJ]))switch(P=M.outp[this.ABOVE],v=H.outp[this.ABOVE],A=p.point.x,N=p.point.y+B,W=0!=M.bundle[this.ABOVE][this.CLIP]&&0==M.bside[this.CLIP]||0!=H.bundle[this.ABOVE][this.CLIP]&&0!=H.bside[this.CLIP]||0==M.bundle[this.ABOVE][this.CLIP]&&0==H.bundle[this.ABOVE][this.CLIP]&&0!=M.bside[this.CLIP]&&0!=H.bside[this.CLIP]?1:0,R=0!=M.bundle[this.ABOVE][this.SUBJ]&&0==M.bside[this.SUBJ]||0!=H.bundle[this.ABOVE][this.SUBJ]&&0!=H.bside[this.SUBJ]||0==M.bundle[this.ABOVE][this.SUBJ]&&0==H.bundle[this.ABOVE][this.SUBJ]&&0!=M.bside[this.SUBJ]&&0!=H.bside[this.SUBJ]?1:0,w=0,T=0,S=0,D=0,t==m.GPC_DIFF||t==m.GPC_INT?(w=0!=W&&0!=R?1:0,T=0!=(W^H.bundle[this.ABOVE][this.CLIP])&&0!=(R^H.bundle[this.ABOVE][this.SUBJ])?1:0,S=0!=(W^M.bundle[this.ABOVE][this.CLIP])&&0!=(R^M.bundle[this.ABOVE][this.SUBJ])?1:0,D=0!=(W^H.bundle[this.ABOVE][this.CLIP]^M.bundle[this.ABOVE][this.CLIP])&&0!=(R^H.bundle[this.ABOVE][this.SUBJ]^M.bundle[this.ABOVE][this.SUBJ])?1:0):t==m.GPC_XOR?(w=W^R,T=W^H.bundle[this.ABOVE][this.CLIP]^(R^H.bundle[this.ABOVE][this.SUBJ]),S=W^M.bundle[this.ABOVE][this.CLIP]^(R^M.bundle[this.ABOVE][this.SUBJ]),D=W^H.bundle[this.ABOVE][this.CLIP]^M.bundle[this.ABOVE][this.CLIP]^(R^H.bundle[this.ABOVE][this.SUBJ]^M.bundle[this.ABOVE][this.SUBJ])):t==m.GPC_UNION&&(w=0!=W||0!=R?1:0,T=0!=(W^H.bundle[this.ABOVE][this.CLIP])||0!=(R^H.bundle[this.ABOVE][this.SUBJ])?1:0,S=0!=(W^M.bundle[this.ABOVE][this.CLIP])||0!=(R^M.bundle[this.ABOVE][this.SUBJ])?1:0,D=0!=(W^H.bundle[this.ABOVE][this.CLIP]^M.bundle[this.ABOVE][this.CLIP])||0!=(R^H.bundle[this.ABOVE][this.SUBJ]^M.bundle[this.ABOVE][this.SUBJ])?1:0),Z=f.getType(w,T,S,D)){case f.EMN:M.outp[this.ABOVE]=a.add_local_min(A,N),H.outp[this.ABOVE]=M.outp[this.ABOVE];break;case f.ERI:null!=P&&(P.add_right(A,N),H.outp[this.ABOVE]=P,M.outp[this.ABOVE]=null);break;case f.ELI:null!=v&&(v.add_left(A,N),M.outp[this.ABOVE]=v,H.outp[this.ABOVE]=null);break;case f.EMX:null!=P&&null!=v&&(P.add_left(A,N),a.merge_right(P,v),M.outp[this.ABOVE]=null,H.outp[this.ABOVE]=null);break;case f.IMN:M.outp[this.ABOVE]=a.add_local_min(A,N),H.outp[this.ABOVE]=M.outp[this.ABOVE];break;case f.ILI:null!=P&&(P.add_left(A,N),H.outp[this.ABOVE]=P,M.outp[this.ABOVE]=null);break;case f.IRI:null!=v&&(v.add_right(A,N),M.outp[this.ABOVE]=v,H.outp[this.ABOVE]=null);break;case f.IMX:null!=P&&null!=v&&(P.add_right(A,N),a.merge_left(P,v),M.outp[this.ABOVE]=null,H.outp[this.ABOVE]=null);break;case f.IMM:null!=P&&null!=v&&(P.add_right(A,N),a.merge_left(P,v),M.outp[this.ABOVE]=a.add_local_min(A,N),H.outp[this.ABOVE]=M.outp[this.ABOVE]);break;case f.EMM:null!=P&&null!=v&&(P.add_left(A,N),a.merge_right(P,v),M.outp[this.ABOVE]=a.add_local_min(A,N),H.outp[this.ABOVE]=M.outp[this.ABOVE])}if(0!=M.bundle[this.ABOVE][this.CLIP]&&(H.bside[this.CLIP]=0==H.bside[this.CLIP]?1:0),0!=H.bundle[this.ABOVE][this.CLIP]&&(M.bside[this.CLIP]=0==M.bside[this.CLIP]?1:0),0!=M.bundle[this.ABOVE][this.SUBJ]&&(H.bside[this.SUBJ]=0==H.bside[this.SUBJ]?1:0),0!=H.bundle[this.ABOVE][this.SUBJ]&&(M.bside[this.SUBJ]=0==M.bside[this.SUBJ]?1:0),F=M.prev,Y=H.next,null!=Y&&(Y.prev=M),M.bstate[this.ABOVE]==g.BUNDLE_HEAD)for(K=!0;K;)F=F.prev,K=null!=F&&F.bstate[this.ABOVE]!=g.BUNDLE_TAIL?!1:!1;null==F?(E.top_node.prev=H,H.next=E.top_node,E.top_node=M.next):(F.next.prev=H,H.next=F.next,F.next=M.next),M.next.prev=F,H.next.prev=H,M.next=Y}for(G=E.top_node;null!=G;G=G.next)Y=G.next,k=G.succ,G.top.y==b&&null!=k?(k.outp[this.BELOW]=G.outp[this.ABOVE],k.bstate[this.BELOW]=G.bstate[this.ABOVE],k.bundle[this.BELOW][this.CLIP]=G.bundle[this.ABOVE][this.CLIP],k.bundle[this.BELOW][this.SUBJ]=G.bundle[this.ABOVE][this.SUBJ],F=G.prev,null!=F?F.next=k:E.top_node=k,null!=Y&&(Y.prev=k),k.prev=F,k.next=Y):(G.outp[this.BELOW]=G.outp[this.ABOVE],G.bstate[this.BELOW]=G.bstate[this.ABOVE],G.bundle[this.BELOW][this.CLIP]=G.bundle[this.ABOVE][this.CLIP],G.bundle[this.BELOW][this.SUBJ]=G.bundle[this.ABOVE][this.SUBJ],G.xb=G.xt),G.outp[this.ABOVE]=null}}return $=a.getResult(n)},EQ:function(t,e){return Math.abs(t-e)<=this.GPC_EPSILON},PREV_INDEX:function(t,e){return(t-1+e)%e},NEXT_INDEX:function(t,e){return(t+1)%e},OPTIMAL:function(t,e){return t.getY(this.PREV_INDEX(e,t.getNumPoints()))!=t.getY(e)||t.getY(this.NEXT_INDEX(e,t.getNumPoints()))!=t.getY(e)},create_contour_bboxes:function(t){for(var e,i=[],n=t.getNumInnerPoly(),s=0;n>s;s++)e=t.getInnerPoly(s),i[s]=e.getBounds();return i},minimax_test:function(t,e,i){var n,s,o,r=this.create_contour_bboxes(t),h=this.create_contour_bboxes(e),u=t.getNumInnerPoly(),l=e.getNumInnerPoly(),d=E.create2DArray(u,l);for(n=0;u>n;n++)for(s=0;l>s;s++)d[n][s]=!(r[n].getMaxX()<h[s].getMinX()||r[n].getMinX()>h[s].getMaxX()||r[n].getMaxY()<h[s].getMinY()||r[n].getMinY()>h[s].getMaxY());for(s=0;l>s;s++){for(o=!1,n=0;!o&&u>n;n++)o=d[n][s];o||e.setContributing(s,!1)}if(i==m.GPC_INT)for(n=0;u>n;n++){for(o=!1,s=0;!o&&l>s;s++)o=d[n][s];o||t.setContributing(n,!1)}},bound_list:function(t,e){var i,n,s,o;if(null==t.top_node)return t.top_node=new l(e),t.top_node;for(i=null,n=t.top_node,s=!1;!s;)e<n.y?(o=n,n=new l(e),n.next=o,null==i?t.top_node=n:i.next=n,s=!0):e>n.y?null==n.next?(n.next=new l(e),n=n.next,s=!0):(i=n,n=n.next):s=!0;return n},insert_bound:function(t,e){var i,n,s;if(null==t.first_bound)t.first_bound=e;else for(i=!1,n=null,s=t.first_bound;!i;)e.bot.x<s.bot.x?(null==n?t.first_bound=e:n.next_bound=e,e.next_bound=s,i=!0):e.bot.x==s.bot.x?e.dx<s.dx?(null==n?t.first_bound=e:n.next_bound=e,e.next_bound=s,i=!0):null==s.next_bound?(s.next_bound=e,i=!0):(n=s,s=s.next_bound):null==s.next_bound?(s.next_bound=e,i=!0):(n=s,s=s.next_bound)},add_edge_to_aet:function(t,e){var i,n,s;if(null==t.top_node)t.top_node=e,e.prev=null,e.next=null;else for(i=t.top_node,n=null,s=!1;!s;)e.xb<i.xb?(e.prev=n,e.next=i,i.prev=e,null==n?t.top_node=e:n.next=e,s=!0):e.xb==i.xb?e.dx<i.dx?(e.prev=n,e.next=i,i.prev=e,null==n?t.top_node=e:n.next=e,s=!0):(n=i,null==i.next?(i.next=e,e.prev=i,e.next=null,s=!0):i=i.next):(n=i,null==i.next?(i.next=e,e.prev=i,e.next=null,s=!0):i=i.next)},add_to_sbtree:function(t,e){var i,n;if(null==t.sb_tree)return t.sb_tree=new S(e),t.sbt_entries++,void 0;for(i=t.sb_tree,n=!1;!n;)i.y>e?null==i.less?(i.less=new S(e),t.sbt_entries++,n=!0):i=i.less:i.y<e?null==i.more?(i.more=new S(e),t.sbt_entries++,n=!0):i=i.more:n=!0},build_lmt:function(t,e,i,n,s){var o,r,h,u,l,d,a,f,_,c,p,x,E,B,b=new P;for(o=0;o<i.getNumInnerPoly();o++)if(r=i.getInnerPoly(o),r.isContributing(0)){h=0,l=0,b=new P;for(var B=0;B<r.getNumPoints();B++)this.OPTIMAL(r,B)&&(f=r.getX(B),_=r.getY(B),b.addNode(f,_),this.add_to_sbtree(e,r.getY(B)),h++);for(var a=0;h>a;a++)if(b.FWD_MIN(a)){for(u=1,d=this.NEXT_INDEX(a,h);b.NOT_FMAX(d);)u++,d=this.NEXT_INDEX(d,h);for(c=a,p=b.getNode(l),p.bstate[this.BELOW]=g.UNBUNDLED,p.bundle[this.BELOW][this.CLIP]=0,p.bundle[this.BELOW][this.SUBJ]=0,B=0;u>B;B++)E=b.getNode(l+B),x=b.getNode(c),E.xb=x.vertex.x,E.bot.x=x.vertex.x,E.bot.y=x.vertex.y,c=this.NEXT_INDEX(c,h),x=b.getNode(c),E.top.x=x.vertex.x,E.top.y=x.vertex.y,E.dx=(x.vertex.x-E.bot.x)/(E.top.y-E.bot.y),E.type=n,E.outp[this.ABOVE]=null,E.outp[this.BELOW]=null,E.next=null,E.prev=null,E.succ=u>1&&u-1>B?b.getNode(l+B+1):null,E.pred=u>1&&B>0?b.getNode(l+B-1):null,E.next_bound=null,E.bside[this.CLIP]=s==m.GPC_DIFF?this.RIGHT:this.LEFT,E.bside[this.SUBJ]=this.LEFT;this.insert_bound(this.bound_list(t,b.getNode(a).vertex.y),p),l+=u}for(a=0;h>a;a++)if(b.REV_MIN(a)){for(u=1,d=this.PREV_INDEX(a,h);b.NOT_RMAX(d);)u++,d=this.PREV_INDEX(d,h);for(c=a,p=b.getNode(l),p.bstate[this.BELOW]=g.UNBUNDLED,p.bundle[this.BELOW][this.CLIP]=0,p.bundle[this.BELOW][this.SUBJ]=0,B=0;u>B;B++)E=b.getNode(l+B),x=b.getNode(c),E.xb=x.vertex.x,E.bot.x=x.vertex.x,E.bot.y=x.vertex.y,c=this.PREV_INDEX(c,h),x=b.getNode(c),E.top.x=x.vertex.x,E.top.y=x.vertex.y,E.dx=(x.vertex.x-E.bot.x)/(E.top.y-E.bot.y),E.type=n,E.outp[this.ABOVE]=null,E.outp[this.BELOW]=null,E.next=null,E.prev=null,E.succ=u>1&&u-1>B?b.getNode(l+B+1):null,E.pred=u>1&&B>0?b.getNode(l+B-1):null,E.next_bound=null,E.bside[this.CLIP]=s==m.GPC_DIFF?this.RIGHT:this.LEFT,E.bside[this.SUBJ]=this.LEFT;this.insert_bound(this.bound_list(t,b.getNode(a).vertex.y),p),l+=u}}else r.setContributing(0,!0);return b},add_st_edge:function(t,e,i,n){var s,o,r,h,u;return null==t?t=new d(i,null):(s=t.xt-t.xb-(i.xt-i.xb),i.xt>=t.xt||i.dx==t.dx||Math.abs(s)<=this.GPC_EPSILON?(o=t,t=new d(i,o)):(r=(i.xb-t.xb)/s,h=t.xb+r*(t.xt-t.xb),u=r*n,e.top_node=this.add_intersection(e.top_node,t.edge,i,h,u),t.prev=this.add_st_edge(t.prev,e,i,n))),t},add_intersection:function(t,e,i,n,s){var o;return null==t?t=new u(e,i,n,s,null):t.point.y>s?(o=t,t=new u(e,i,n,s,o)):t.next=this.add_intersection(t.next,e,i,n,s),t}},L=function(){this.top_node=null};L.prototype={print:function(){}};var g=function(t){this.m_State=t};g.UNBUNDLED=new g("UNBUNDLED"),g.BUNDLE_HEAD=new g("BUNDLE_HEAD"),g.BUNDLE_TAIL=new g("BUNDLE_TAIL"),g.prototype={toString:function(){return this.m_State}};var P=function(){this.m_List=new B};P.prototype={addNode:function(t,e){var i=new r;i.vertex.x=t,i.vertex.y=e,this.m_List.add(i)},getNode:function(t){return this.m_List.get(t)},FWD_MIN:function(t){var e=this.m_List,i=e.get(b.PREV_INDEX(t,e.size())),n=e.get(b.NEXT_INDEX(t,e.size())),s=e.get(t);return i.vertex.y>=s.vertex.y&&n.vertex.y>s.vertex.y},NOT_FMAX:function(t){var e=this.m_List,i=e.get(b.NEXT_INDEX(t,e.size())),n=e.get(t);return i.vertex.y>n.vertex.y},REV_MIN:function(t){var e=this.m_List,i=e.get(b.PREV_INDEX(t,e.size())),n=e.get(b.NEXT_INDEX(t,e.size())),s=e.get(t);return i.vertex.y>s.vertex.y&&n.vertex.y>=s.vertex.y},NOT_RMAX:function(t){var e=this.m_List,i=e.get(b.PREV_INDEX(t,e.size())),n=e.get(t);return i.vertex.y>n.vertex.y}};var I=function(){this.top_node};I.prototype.build_intersection_table=function(t,e){var i,n=null;for(i=t.top_node;null!=i;i=i.next)(i.bstate[b.ABOVE]==g.BUNDLE_HEAD||0!=i.bundle[b.ABOVE][b.CLIP]||0!=i.bundle[b.ABOVE][b.SUBJ])&&(n=b.add_st_edge(n,this,i,e))};var v={equalPoint:function(t,e){return t[0]==e[0]&&t[1]==e[1]},equalVertex:function(t,e,i,n){return this.equalPoint(t,i)&&this.equalPoint(e,n)||this.equalPoint(t,n)&&this.equalPoint(e,i)},distancePoints:function(t,e){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))},clonePoint:function(t){return[t[0],t[1]]},cloneLine:function(t){for(var e=[],i=t.length,n=0;i>n;n++)e[n]=[t[n][0],t[n][1]];return e},addLineToLine:function(t,e){for(var i=e.length,n=0;i>n;n++)t.push(clonePoint(e[n]))},roundPoint:function(t){t[0]=Math.round(t[0]),t[1]=Math.round(t[1])},pointLineDistance:function(t,e){var i,n,s,o,r=t[0]-e[0][0],h=t[1]-e[0][1],u=e[1][0]-e[0][0],l=e[1][1]-e[0][1],d=r*u+h*l,a=u*u+l*l,f=-1;return 0!=a&&(f=d/a),0>f?(i=e[0][0],n=e[0][1]):f>1?(i=e[1][0],n=e[1][1]):(i=e[0][0]+f*u,n=e[0][1]+f*l),s=t[0]-i,o=t[1]-n,Math.floor(Math.sqrt(s*s+o*o))},lineIntersect:function(t,e){var i,n,s=(e[1][1]-e[0][1])*(t[1][0]-t[0][0])-(e[1][0]-e[0][0])*(t[1][1]-t[0][1]);if(0!==s)return i=((e[1][0]-e[0][0])*(t[0][1]-e[0][1])-(e[1][1]-e[0][1])*(t[0][0]-e[0][0]))/s,n=((t[1][0]-t[0][0])*(t[0][1]-e[0][1])-(t[1][1]-t[0][1])*(t[0][0]-e[0][0]))/s,i>=0&&1>=i&&n>=0&&1>=n?[t[0][0]+i*(t[1][0]-t[0][0]),t[0][1]+i*(t[1][1]-t[0][1])]:void 0}},O=function(){this.top_node};O.prototype.print=function(){for(var t=0,e=this.top_node;null!=e;)t++,e=e.next};var m=function(t){this.m_Type=t};m.GPC_DIFF=new m("Difference"),m.GPC_INT=new m("Intersection"),m.GPC_XOR=new m("Exclusive or"),m.GPC_UNION=new m("Union");var A=function(t){null==t&&(t=!1),this.m_IsHole=t,this.m_List=new B};A.prototype={equals:function(t){if(!(t instanceof A))return!1;var e=t;return this.m_IsHole!=e.m_IsHole?!1:p(this.m_List,e.m_List)?!0:!1},hashCode:function(){return 629+this.m_List.hashCode()},clear:function(){this.m_List.clear()},add:function(e,i){var n,s,o,r=[];if(r[0]=e,i&&(r[1]=i),2==r.length)this.addPointXY(r[0],r[1]);else if(1==r.length)if(r[0]instanceof t)this.addPoint(r[0]);else if(r[0]instanceof V)this.addPoly(r[0]);else if(r[0]instanceof Array)if(n=r[0],2==n.length&&n[0]instanceof Number&&n[1]instanceof Number)this.add(n[0],n[1]);else for(s=0,o=r[0].length;o>s;s++)this.add(r[0][s])},addPointXY:function(e,i){this.addPoint(new t(e,i))},addPoint:function(t){var e=this.m_List;0==e.size()&&e.add(new V),e.get(0).addPoint(t)},addPoly:function(t){var e=this.m_IsHole,i=this.m_List;if(i.size()>0&&e)throw"ERROR : Cannot add polys to something designated as a hole.";i.add(t)},isEmpty:function(){return this.m_List.isEmpty()},getBounds:function(){var t,e=this.m_List;return 0==e.size()?new o:1==e.size()?(t=this.getInnerPoly(0),t.getBounds()):(console.log("getBounds not supported on complex poly."),void 0)},getInnerPoly:function(t){return this.m_List.get(t)},getNumInnerPoly:function(){return this.m_List.size()},getNumPoints:function(){return this.m_List.get(0).getNumPoints()},getX:function(t){return this.m_List.get(0).getX(t)},getPoint:function(t){return this.m_List.get(0).getPoint(t)},getPoints:function(){return this.m_List.get(0).getPoints()},isPointInside:function(t){var e,i,n,s=this.m_List;if(!s.get(0).isPointInside(t))return!1;for(e=0,i=s.size();i>e;e++)if(n=s.get(e),n.isHole()&&n.isPointInside(t))return!1;return!0},getY:function(t){return this.m_List.get(0).getY(t)},isHole:function(){if(this.m_List.size()>1)throw"Cannot call on a poly made up of more than one poly.";return this.m_IsHole},setIsHole:function(t){if(this.m_List.size()>1)throw"Cannot call on a poly made up of more than one poly.";this.m_IsHole=t},isContributing:function(t){return this.m_List.get(t).isContributing(0)},setContributing:function(t,e){if(1!=this.m_List.size())throw"Only applies to polys of size 1";this.m_List.get(t).setContributing(0,e)},intersection:function(t){return b.intersection(t,this,"PolyDefault")},union:function(t){return b.union(t,this,"PolyDefault")},xor:function(t){return b.xor(t,this,"PolyDefault")},difference:function(t){return b.difference(t,this,"PolyDefault")},getArea:function(){for(var t,e,i=0,n=this.getNumInnerPoly(),s=0;n>s;s++)t=this.getInnerPoly(s),e=t.getArea()*(t.isHole()?-1:1),i+=e;return i},toString:function(){for(var e,i,n,s,o="",r=this.m_List,h=r.size(),u=0;h>u;u++){for(i=this.getInnerPoly(u),o+="InnerPoly("+u+").hole="+i.isHole(),e=[],n=0,s=i.getNumPoints();s>n;n++)e.push(new t(i.getX(n),i.getY(n)));for(e=E.sortPointsClockwise(e),n=0,s=e.length;s>n;n++)o+=e[n].toString()}return o}};var N=function(){this.maxTop,this.maxBottom,this.maxLeft,this.maxRight,this.vertices};N.prototype={fromArray:function(e){var i,n=0,s=e.length;for(this.vertices=[];s>n;n++)i=e[n],this.vertices.push(new t(i[0],i[1]))},normalize:function(){for(var t,e,i,n,s,o=this.vertices,r=this.vertices,h=o.length,u=0,l=!1;h>u;u++)e=o[u],(null==maxTop||maxTop.y>e.y||maxTop.y==e.y&&e.x<maxTop.x)&&(maxTop=e),(null==maxBottom||maxBottom.y<e.y||maxBottom.y==e.y&&e.x>maxBottom.x)&&(maxBottom=e),(null==maxRight||maxRight.x<e.x||maxRight.x==e.x&&e.y<maxRight.y)&&(maxRight=e),(null==maxLeft||maxLeft.x>e.x||maxLeft.x==e.x&&e.y>maxLeft.y)&&(maxLeft=e,t=u);if(t>0){for(r=[],i=0,u=t,h=o.length;h>u;u++)r[i++]=this.vertices[u];for(u=0;t>u;u++)r[i++]=this.vertices[u];o=r}for(n=0,s=this.vertices.length;s>n;n++){if(e=this.vertices[n],p(e,maxBottom)){l=!0;break}if(p(e,maxTop))break}if(l){for(r=[],r[0]=o[0],i=1,u=o.length-1;u>0;u--)r[i++]=this.vertices[u];o=r}},getVertexIndex:function(t){for(var e=0,i=this.vertices.length;i>e;e++)if(p(vertices[e],t))return e;return-1},insertVertex:function(t,e,i){var n,s,o,r=getVertexIndex(t),h=getVertexIndex(e);if(-1==r||-1==h)return!1;if(r>h&&(s=r,r=h,h=s),h==r+1){for(n=[],s=0;r>=s;s++)n[s]=this.vertices[s];for(n[h]=i,s=h,o=this.vertices.length;o>s;s++)n[s+1]=this.vertices[s];this.vertices=n}else h==vertices.length-1&&0==r&&this.vertices.push(i);return!0},clone:function(){var t=new N;return t.vertices=vertices.slice(this.vertices.length-1),t},toString:function(){for(var t,e=this.vertices,i="[",n=e.length,s=0;n>s;s++)t=e[s],i+=(s>0?",":"")+"["+t.x+","+t.y+"]";return i+="]"}};var C=function(t,e,i){var n=new a(e,i);this.v=[],this.v[b.LEFT]=n,this.v[b.RIGHT]=n,this.next=t,this.proxy=this,this.active=1,this.hole};C.prototype={add_right:function(t,e){var i=new a(t,e);this.proxy.v[b.RIGHT].next=i,this.proxy.v[b.RIGHT]=i},add_left:function(t,e){var i=this.proxy,n=new a(t,e);n.next=i.v[b.LEFT],i.v[b.LEFT]=n}};var V=function(){this.m_List=new B,this.m_Contributes=!0};V.prototype={equals:function(t){if(!(t instanceof V))return!1;var e,i,n,s,o,r,h,u=t,l=this.m_List.size(),d=u.m_List.size();if(l!=d)return!1;if(l>0){for(e=this.getX(0),i=this.getY(0),h=-1,r=0;-1==h&&d>r;r++)s=u.getX(r),o=u.getY(r),e==s&&i==o&&(h=r);if(-1==h)return!1;for(r=h,n=0;l>n;n++){if(e=this.getX(n),i=this.getY(n),s=u.getX(r),o=u.getY(r),e!=s||i!=o)return!1;r++,r>=d&&(r=0)}}return!0},hashCode:function(){var t=17;return t=37*t+this.m_List.hashCode()},toString:function(){return"PolySimple: num_points="+getNumPoints()},clear:function(){this.m_List.clear()},add:function(e,i){var n,s,o,r=[];if(r[0]=e,i&&(r[1]=i),2==r.length)this.addPointXY(r[0],r[1]);else if(1==r.length)if(r[0]instanceof t)this.addPoint(r[0]);else if(r[0]instanceof Poly)this.addPoly(r[0]);else if(r[0]instanceof Array)for(s=0,o=r[0].length;o>s;s++)n=r[0][s],this.add(n)},addPointXY:function(e,i){this.addPoint(new t(e,i))},addPoint:function(t){this.m_List.add(t)},addPoly:function(){throw"Cannot add poly to a simple poly."},isEmpty:function(){return this.m_List.isEmpty()},getBounds:function(){for(var t,e,i=Number.MAX_VALUE,n=Number.MAX_VALUE,s=-Number.MAX_VALUE,r=-Number.MAX_VALUE,h=this.m_List.size(),u=0;h>u;u++)t=this.getX(u),e=this.getY(u),i>t&&(i=t),t>s&&(s=t),n>e&&(n=e),e>r&&(r=e);return new o(i,n,s-i,r-n)},getInnerPoly:function(t){return 0!=t&&alert("PolySimple only has one poly"),this},getNumInnerPoly:function(){return 1},getNumPoints:function(){return this.m_List.size()},getX:function(t){return this.m_List.get(t).x},getY:function(t){return this.m_List.get(t).y},getPoint:function(t){return this.m_List.get(t)},getPoints:function(){return this.m_List.toArray()},isPointInside:function(t){for(var e=this.getPoints(),i=e.length-1,n=!1,s=e.length,o=0;s>o;o++)(e[o].y<t.y&&e[i].y>=t.y||e[i].y<t.y&&e[o].y>=t.y)&&e[o].x+(t.y-e[o].y)/(e[i].y-e[o].y)*(e[i].x-e[o].x)<t.x&&(n=!n),i=o;return n},isHole:function(){return!1},setIsHole:function(){throw"PolySimple cannot be a hole"},isContributing:function(t){if(0!=t)throw"PolySimple only has one poly";return this.m_Contributes},setContributing:function(t,e){if(0!=t)throw"PolySimple only has one poly";this.m_Contributes=e},intersection:function(t){return b.intersection(this,t,"PolySimple")},union:function(t){return b.union(this,t,"PolySimple")},xor:function(t){return b.xor(t,this,"PolySimple")},difference:function(t){return b.difference(t,this,"PolySimple")},getArea:function(){var t,e,i,n,s,o,r,h,u,l=0;if(this.getNumPoints()<3)return 0;for(t=this.getX(0),e=this.getY(0),h=1,u=this.getNumPoints()-1;u>h;h++)i=this.getX(h),n=this.getY(h),s=this.getX(h+1),o=this.getY(h+1),r=(s-i)*(e-n)-(t-i)*(o-n),l+=r;return l=.5*Math.abs(l)}};var U=function(){this.top_node};U.prototype={add_local_min:function(t,e){var i=this.top_node;return this.top_node=new C(i,t,e),this.top_node},merge_left:function(t,e){var i,n,s=this.top_node;if(e.proxy.hole=!0,t.proxy!=e.proxy)for(t.proxy.v[b.RIGHT].next=e.proxy.v[b.LEFT],e.proxy.v[b.LEFT]=t.proxy.v[b.LEFT],i=t.proxy,n=s;null!=n;n=n.next)n.proxy==i&&(n.active=0,n.proxy=e.proxy)},merge_right:function(t,e){var i,n,s=this.top_node;if(e.proxy.hole=!1,t.proxy!=e.proxy)for(e.proxy.v[b.RIGHT].next=t.proxy.v[b.LEFT],e.proxy.v[b.RIGHT]=t.proxy.v[b.RIGHT],i=t.proxy,n=s;null!=n;n=n.next)n.proxy==i&&(n.active=0,n.proxy=e.proxy)},count_contours:function(){for(var t,e,i=0,n=this.top_node;null!=n;n=n.next)if(0!=n.active){for(t=0,e=n.proxy.v[b.LEFT];null!=e;e=e.next)t++;t>2?(n.active=t,i++):n.active=0}return i},getResult:function(t){var e,i,n,s,o,r,h,u,l,d=this.top_node,a=b.createNewPoly(t),f=this.count_contours();if(f>0){for(s=0,e=null,i=d;null!=i;i=e)if(e=i.next,0!=i.active){for(n=a,f>1&&(n=b.createNewPoly(t)),i.proxy.hole&&n.setIsHole(i.proxy.hole),h=i.proxy.v[b.LEFT];null!=h;h=h.next)n.add(h.x,h.y);f>1&&a.addPoly(n),s++}for(u=a,a=b.createNewPoly(t),o=0,r=u.getNumInnerPoly();r>o;o++)l=u.getInnerPoly(o),l.isHole()||a.addPoly(l);for(o=0,r=u.getNumInnerPoly();r>o;o++)l=u.getInnerPoly(o),l.isHole()&&a.addPoly(l)}return a},print:function(){var t,e,i=this.top_node,n=0,s=null;for(t=i;null!=t;t=s)s=t.next,0!=t.active&&(e=0,n++)}};var S=function(t){this.y=t,this.less,this.more},J=function(){this.sbt_entries=0,this.sb_tree};J.prototype={build_sbt:function(){var t=[],e=0;return e=this.inner_build_sbt(e,t,this.sb_tree),t},inner_build_sbt:function(t,e,i){return null!=i.less&&(t=this.inner_build_sbt(t,e,i.less)),e[t]=i.y,t++,null!=i.more&&(t=this.inner_build_sbt(t,e,i.more)),t}};var D={pointLineDistance:v.pointLineDistance,lineIntersect:v.lineIntersect,distancePoints:v.distancePoints,getArea:function(t){var e=_(t);return e.getArea()},clip:function(t,e,i){for(var n,s=_(e),o=_(i),r=s[t](o),h=r.getNumInnerPoly(),u=0,l=[];h>u;u++)n=r.getInnerPoly(u),l.push({vertices:c(n),isHole:n.isHole()});return l}};window.polyop=D}();